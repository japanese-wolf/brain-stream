---
description: "ダイジェストの記事を対話的に深掘りする"
allowed-tools: [WebFetch, WebSearch, Read, Write, Bash]
---

# BrainStream Explore

最新のダイジェストから興味のある記事を選び、対話的に深掘りする。

## 重要な制約

- **事実の正確性**: 原文にない情報を追加しない。
- **ソース必須**: 深掘りで参照した情報には必ず出典 URL を添付する。
- **出力言語**: 日本語で出力する。

## 実行プロトコル

### Step 1: ダイジェストの読み込み

1. `.claude/brainstream/digests/` ディレクトリ内の最新の `.md` ファイルを探す:
   ```
   Bash: ls -t .claude/brainstream/digests/*.md 2>/dev/null | head -1
   ```

2. 対応するキャッシュ JSON も読み込む:
   ```
   Bash: ls -t .claude/brainstream/cache/*.json 2>/dev/null | head -1
   ```

3. **ダイジェストが存在しない場合**:
   - 「ダイジェストが見つかりません。先に `/brainstream:digest` を実行してください。」と表示して停止。

4. ダイジェストの日時をユーザーに表示:
   - 「最新のダイジェスト: [タイムスタンプ]」

### Step 2: クラスタ選択

キャッシュ JSON からクラスタ一覧を抽出し、AskUserQuestion で提示する。

```
質問: どのクラスタを深掘りしますか？
選択肢: （キャッシュの clusters から動的生成）
  - [クラスタ名1]（N件）
  - [クラスタ名2]（N件）
  - [クラスタ名3]（N件）
  - 全体を俯瞰する
multiSelect: false
```

- 「全体を俯瞰する」が選ばれた場合 → Step 3 をスキップし、全クラスタのトレンド分析を Step 4 で実行。
- クラスタが選ばれた場合 → Step 3 へ。

### Step 3: 記事選択

選択されたクラスタ内の記事一覧を AskUserQuestion で提示する。

```
質問: どの記事を深掘りしますか？
選択肢: （クラスタ内の記事から動的生成）
  - [記事タイトル1]
  - [記事タイトル2]
  - [記事タイトル3]
  - クラスタ全体のトレンド分析
multiSelect: true
```

### Step 4: 深掘り実行

#### 個別記事の深掘り

選択された各記事について:

1. **元記事の全文取得**: キャッシュの URL を WebFetch で取得する。
   ```
   WebFetch URL: 「この記事の全文を要約してください。技術的な詳細、背景、影響を含めてください。」
   ```

2. **構造化された深掘り分析**を生成:

```markdown
## [記事タイトル]

### 詳細

[元記事の内容に基づく詳細な要約。3-5段落。]

### 技術的背景

[この発表/変更の技術的コンテキスト。何が前提にあり、何が変わったのか。]

### 影響範囲

- **誰に影響するか**: [対象ユーザー/開発者]
- **どう変わるか**: [具体的な変化]
- **いつから**: [適用時期が分かれば]

### 関連情報

- [関連する他の記事やトレンドとの関係]

🔗 [元記事URL]
```

3. **関連記事の提案**: 同じダイジェスト内で関連する記事があれば提示する。

#### クラスタ/全体のトレンド分析

1. クラスタ内（または全体）の記事を俯瞰する。
2. 以下の分析を生成:

```markdown
## トレンド分析: [クラスタ名 / 全体]

### 主要な動き

[今回のダイジェストで見られる主要な動向。3-5点。]

### ベンダー動向

| ベンダー | 動き | 注目度 |
|---------|------|--------|
| [ベンダー名] | [何をしているか] | 高/中/低 |

### 今後の注目ポイント

[今回の動向から推測される今後の注目ポイント。ただし推測は最小限に留め、事実ベースで。]
```

### Step 5: 継続/終了

深掘り結果を表示後、AskUserQuestion で次のアクションを確認する。

```
質問: 次のアクションを選んでください。
選択肢:
  - 別の記事を深掘りする（→ Step 2 に戻る）
  - 追加の質問をする
  - 終了する
multiSelect: false
```

- 「別の記事を深掘りする」→ Step 2 に戻る
- 「追加の質問をする」→ ユーザーの自由入力を待ち、現在のコンテキストで回答する
- 「終了する」→ 終了

### Step 6: 行動履歴の記録（opt-in）

`.claude/brainstream/config.json` を読み、`history_tracking` が `true` の場合のみ:

`.claude/brainstream/history/actions.json` に以下を追記する:

```json
{
  "timestamp": "ISO-8601",
  "action": "explore",
  "selected_clusters": ["cluster-name"],
  "selected_articles": ["article-url-1", "article-url-2"],
  "topics_explored": ["topic1", "topic2"]
}
```

この履歴は将来の digest でのパーソナライズ（関心の高いトピックの優先）に活用される。

## 引数

`$ARGUMENTS` の解釈:

- **指定なし** — 最新のダイジェストを対話的に深掘り
- **クラスタ名** — そのクラスタを直接選択して深掘り開始
